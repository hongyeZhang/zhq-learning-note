

## 参考资料
* https://juejin.cn/post/6953190243193323528



## 基础笔记


* 架构可根据从业务需求到系统实现的不同需要分为：业务架构、应用架构、数据架构、技术架构



## 业务架构
业务架构是对业务需求的提炼和抽象，使用一套方法论对产品（项目）所涉及需求的业务进行业务边界划分，简单地讲就是根据一套逻辑思路进行业务的拆分


## 应用架构
应用架构介于业务与技术之间，是对整个系统实现的总体架构，需要指出系统的层次、系统开发的原则、系统各个层次的应用服务

应用架构的设计原则如下。
（1）稳定
◎ 一切以稳定为中心。
◎ 架构尽可能简单、清晰，追求小而美，不要大而全。
◎ 不过度设计。
（2）解耦
◎ 将稳定部分与易变部分分离。
◎ 将核心业务与非核心业务分离。
◎ 将电商主流程和辅助流程分离。
◎ 将应用与数据分离。
◎ 将服务和实现细节分离。（3）抽象
◎ 应用抽象化：应用只依赖服务抽象，不依赖服务实现的细节和位置。
◎ 数据库抽象化：应用只依赖逻辑数据库，不需要关心物理库的位置和分片。
◎ 服务抽象化：应用虚拟化部署，不需要关心实体机的配置，动态调配资源。
（4）松耦合
◎ 跨域调用异步化：在不同的业务域之间尽量异步解耦。
◎ 非核心业务尽量异步化：在核心业务和非核心业务之间尽量异步化。
◎ 在必须同步调用时，需要设置超时时间和任务队列的长度。
（5）容错设计
◎ 服务自治：服务能彼此独立修改、部署、发布和管理，避免引发连锁反应。
◎ 集群容错：应用系统集群部署，避免单点服务。
◎ 多机房容灾：多机房部署、多活。




## 技术架构
技术架构就是对在业务架构中提出的功能（或服务）进行技术方案的实现，包括软件系统实现、操作系统选择和运行时设计。技术架构的边界比较模糊，对于不同的受众，内容的详细程度也不同，
技术栈自上而下比较关注技术架构，但是各层关注的点不同。技术决策层可能关心的是系统或系统群的技术选型，对整体的把握要保证不因为选型引起其他风险。


技术架构的设计原则如下。
（1）无状态，即尽量不要把状态数据保存在本机上。
（2）可复用。
◎ 复用粒度是有业务逻辑的抽象服务，不是服务的实现细节。
◎ 服务引用只依赖服务抽象。
（3）松耦合
◎ 跨业务域调用，尽可能异步解耦。◎ 在同步调用时设置超时时间和队列大小。
◎ 将相对稳定的基础服务与易变流程服务分离。
（4）可治理
◎ 服务可降级。
◎ 服务可限流。
◎ 服务可开关。
◎ 服务可监控。
◎ 白名单机制。
◎ 制定服务契约。
（5）基础服务
◎ 基础服务下沉、可复用，例如时效、库存和价格计算。
◎ 基础服务自治、相对独立。
◎ 对基础服务的实现要精简，并可水平扩展。
◎ 对基础服务的实现要进行物理隔离，包括基础服务相关的数据。



## 数据架构
* 数据架构是对存储数据（资源）的架构，其设计原则和应用架构。设计大同小异，在设计时需要考虑系统的业务场景，需要根据不同的业务场景对数据进行异构设计、数据库读写分离、分布式数据存储策略等

数据架构的设计原则如下。
（1）统一数据视图，即保证数据的及时性、一致性、准确性和完整性。
（2）数据和应用分离。
◎ 应用系统只依赖逻辑数据库。
◎ 应用系统不直接访问其他应用的数据库，只能通过接口访问。
（3）数据异构，即在源数据和目标数据内容相同时做索引异构，在商品库不同维度的内容不同时（如订单数据中的买家库和卖家库）做数据库异构。
（4）数据库读写分离。
◎ 将访问量大的数据库做读写分离，例如订单库。
◎ 将数据量大的数据库做分库分表。
◎ 将不同业务域的数据库做分区隔离。◎ 对重要的数据配置备库。
（5）采用关系数据库。除成本因素外，MySQL 的数据库扩展性和高并发支持能力较强，也比较容易招聘到相关的研发人员和运维人员。
（6）合理利用 NoSQL 数据库。在数据库有能力支撑时，尽量不要引入缓存。另外，要合理利用缓存做容灾。









