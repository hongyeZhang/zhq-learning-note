# 设计模式学习笔记

## 基本思想
* 初期是代码的优化，中期是设计模式的使用，后期是把控全局服务的搭建

## 参考资料
* 《重学java设计模式》 小傅哥
* 

## 基础知识
* 23 种设计模式
* SOLID 原则 （单一职责、 开闭原则、 里氏替换、 接口隔离以及依赖反转）
* 设计模式遵循的六大原则
    * 单一职责（一个类和方法只做一件事）
    * 里氏替换（多态，子类可替换父类）
    * 依赖倒置（细节依赖抽象，下层依赖上层）
    * 接口隔离（建立单一接口）
    * 迪米特原则（最少知道，降低耦合）
    * 开闭原则（抽象架构，扩展实现）



## 对比与比较

### 简单工厂、工厂方法、抽象工厂



## TODO
* UML 图



# 各种设计模式

## 一、创建型模式
### 1 工厂方法模式
* 定义一个创建对象的接口，让其子类自己决定实例化哪一个工厂类，工厂模式使其创建过程延迟到子类进行
* 缺点
    * 需要实现的类非常多
* 场景应用
    * 模拟发奖（多种商品），实际上策略模式也可以实现

### 2 抽象工厂模式
* 抽象工厂是一个中心工厂，创建其他的工厂模式
* 场景应用
    * redis集群的切换过程，新老集群同时兼容，可应用于多种redis方案的切换

### 3 建造者模式
* 将多个简单的对象一步步组装成一个复杂的对象，讲一个复杂的构建与其表示分离，使得同样的构建过程可以创建不同的表示
* 由于需求的变化，这个复杂对象的各个部分经常面临重大的变化，但是它们组合在一起的过程却相对稳定，即基本物料不变，组合却经常变化
* 场景应用
    * 不同的装修级别和风格，采用不同的无聊组合，形成不同的装修方案

### 4 原型模式
* 主要解决创建重复对象的问题，生成过程可能从库或者RPC接口中获取数据，采用克隆的方式节省时间
* 场景应用
    * 同样的题目，组合成不同的试卷

### 5 单例模式
* 最简单的设计模式，保证一个类只有一个实例，不管是单线程还是多线程访问
* 主要解决一个全局使用类的频繁创建和销毁，从而提升整体代码的性能
* 场景应用
    * spring 中的单例bean
* 实现方式（7种）
    * 懒汉模式、饿汉模式，线程是否安全等


## 二、结构性模式
### 6 适配器模式
* 将原本不兼容的接口，通过适配修改做到统一，主要解决的问题是多种差异化类型的接口做统一输出
* 场景应用
    * MQ消息的适配
    * 同样功能，不同形式的接口适配以及统一化问题

### 7 桥接模式
* 将抽象部分与实现部分分离，把多种可匹配的部分进行组合
* A 类中含有 B 类的接口，通过构造函数传递B类的实现，B类就是设计的桥
* 场景应用
    * JDBC多种驱动程序的实现
    * 多支付途径（微信、支付宝）与多模式（指纹、刷脸、密码）的融合使用

### 8 组合模式
* 将相似对象组合成一组可被调用的结构树对象
* 解决一系列简单的逻辑节点或者扩展的复杂逻辑节点在不同结构的组织下，对于外部的调用仍然是非常简单的
* 场景应用
    * 创建决策树，给不同的人（性别、年龄）发放不同类型的优惠券，

### 9 装饰器模式
* 在不改变原来类的基础上增加新功能
* 应用场景
    * JDK 的输入、输出流
    * 单点登录功能的扩充

### 10 外观模式
* 也叫门面模式，降低调用方式用接口的复杂度。调用方与实际的接口提供方提供了一个中间层，用于包装逻辑实现API接口
* 应用场景
    * 对于业务接口实现白名单访问的功能

### 11 享元模式
* 主要在于共享通用对象，减少内存的使用，提升系统的访问效率，而这部分内存通常比较耗费内存或者数据库资源，或者需要查询大量的RPC接口
* 应用场景
    * 非变化的热点数据在本地缓存
    * 通过本地的map保存映射与缓存的关系

### 12 代理模式
* 为某些资源的访问，对象的操作提供方便的代理服务
* 应用场景
    * mybatis的核心实现
    * 数据访问层提供一个较为基础的服务，避免服务扩容时数据库的连接数暴增



## 行为模式

### 13 责任链模式
* 解决一个服务中的先后执行处理关系，外部的调用不需要关心责任链内部是怎样处理的
* 应用场景
    * 工单审批的时候，需要的审核人级别不同，审核的次数也不同


### 14 命令模式
* 将逻辑实现与操作请求进行分离，实现过程中比较重要的角色：抽象命令类、具体的命令实现类、实现者、调用者
* 应用场景
    * 不同菜系的点菜过程

### 15 迭代器模式
* 以相同的方式遍历集合结构，而不用管该集合结构的实现，无论是数组、链表、树等
* 应用场景
    * 遍历一个公司的组织架构


### 16 中介者模式
* 在服务提供方，中间添加一层中介者包装服务，对外提供能力
* 应用场景
    * mybatis ORM 框架的实现


### 17 备忘录模式
* 不破坏原有对象的基础上实现备忘录类，记录原对象的行为从而实现备忘录模式
* 应用场景
    * 回滚、配置、悔棋等功能的实现


### 18 观察者模式
* 当一个行为发生时传递信息给另外几个对象，二者之间没有直接的耦合关系
* 主要分离出核心流程和辅助流程的代码，一般核心流程不会改变，但是辅助流程会随着业务需求不断变化，但是事件的时间控制不一定满足顺序，需要注意
* 应用场景
    * 主流程结束之后，发消息，发短信等


### 19 状态模式
* 描述的是一个行为下的多种状态的变更
* 应用场景
    * 营销活动审核状态的流转

### 20 策略模式
* 一般是具有同类可替代的行为逻辑算法场景
* 应用场景
    * 不同营销活动的计算活动价格
    
### 21 模板模式
* 抽象类中定义抽象方法的执行顺序，并将抽象方法设定为只有子类实现，不设计独立访问的方法
* 应用场景
    * 任何可以将流程总结为几步的场景
    * 电商的爬虫程序、定时task，定义基本的流程，实现各自不同的方法，


### 22 访问者模式
* 在一个稳定的数据结构下，不同的访问者关注的东西不同，即访问逻辑是易变的，同一种事物在不同视角下的访问信息不同
* 整体设计结构比较复杂
* 应用场景
    * 校长和家长对于老师和学生的关注信息不同


